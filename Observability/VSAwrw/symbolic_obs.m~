    u= sym('u',[3,1]);
    U= sym('U',[3,4]);
    x =sym('x',[7,1]);
    Bk = sys.Bk;
    u1i = sys.u1i;
    u2i = sys.u2i;
    x0 =sys.x0;
    N1=sys.N1;
    Rl=sys.R1;
    PI=sys.PI;
    beta1 = sys.beta1;
    beta2 =sys.beta2;
    alpha1 = sys.alpha1;
    alpha2 = sys.alpha2;
    Rp = sys.Rp;
    Im = sys.Im;
    bm = sys.bm;
    invM = sys.invM;
    Kk = sys.Kk;        


        del1 = x0-Rl*(x(1)+PI/2)+Rp*(x(4)-u1i);
        del2 = x0+Rl*(x(1)+PI/2)-Rp*(x(5)-u2i);
        
        T1 = alpha1*del1*del1 + beta1*del1; %// tendon tension !
        T2 = alpha2*del2*del2 + beta2*del2;
        
        a = ( (T1 - T2)*Rl - Bk(1,1)*x(2)- cos(x(1))*N1);
        b = (u(3)- Bk(2,2)*x(3));
        
        dy01 = x(2);
        dy02 = invM(1,1)*a + invM(1,2)*b;
        dy03 = invM(2,1)*a + invM(2,2)*b; 
        dy04 = x(6) ;
        dy05 = x(7);
        dy06 = (Kk*(u(1)) - (T1)*Rp - bm*x(6))/Im;
        dy07 = (Kk*(u(2)) + (T2)*Rp - bm*x(7))/Im;
      dy = vpa(subs([dy01;dy02;dy03;dy04;dy05;dy06;dy07],u, U(:,1)),5);
      
C=zeros(4,7);
C(1,1)=1;
C(2,3)=1;
C(3,4)=1;
C(4,5)=1;
Y=sym(zeros(7,4));
for ind=1:4
    K(:,ind) = C(ind,:)*x;
end
for ind1=1:4
    for ind2=2:7
        K(:,ind1) = lder(K(ind2-1,ind),dy,x) + lder(K(i))
    end
end